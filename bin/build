#!/usr/bin/env sh
set -e

# Clean output directory
rm -rf dist

# Build templates from TypeScript source
ts-node scripts/build-templates.ts

# Format generated files
pnpm fixstyle

# Compile TypeScript (ESM)
tsc -p tsconfig.json

# Compile TypeScript (CommonJS)
tsc -p tsconfig.cjs.json
echo '{"type": "commonjs"}' > dist/cjs/package.json
